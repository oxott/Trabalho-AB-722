function varargout = OHara_plot
%OHara_plot plots the pilot opinion contours for the short-period mode that
%resulted from the work of O'Hara (1967) (Figure 4 of the paper)
%
%Author of the function: Antônio B. G. Neto, ITA, Brazil, 2018-10-30
%
%   Simply call OHara_plot in the command window, script or function
%   Alternatively, you may include a single output as in:
%   fig_handle = OHara_plot;
%   fig_handle will then return the handle to the figure object that was
%   created by OHara_plot
%
%   The data points for this function were obtained from the original plot
%   in O'Hara (1967), using the on-line tool WebPlotDigitizer:
%   https://apps.automeris.io/wpd/
%
%   Reference:
%   O'HARA, F. Handling Criteria. Journal of the Royal Aeronautical 
%     Society, v. 71, n. 676, p. 271-291, 1967.

sat_points = [0.6592546026823083 3.6856912878787886
    0.7097319730282373 3.7161458333333335
    0.7640742612779222 3.7314488636363645
    0.818793139341126 3.7164393939393943
    0.8896527895889146 3.686306818181819
    0.9489789840466003 3.625833333333334
    1.0029689644980784 3.5501893939393945
    1.0551539266478407 3.4366571969696973
    1.089767481264975 3.2852083333333337
    1.0948041106291733 3.118551136363637
    1.0698516096368984 2.9594128787878793
    1.035870629511293 2.83813446969697
    0.9756005683473422 2.7167992424242433
    0.8896527895889146 2.580246212121213
    0.8340354205193564 2.4967803030303033
    0.7927863612568494 2.4436458333333335
    0.7262852852836137 2.3677083333333346
    0.6653625004134024 2.314498106060606
    0.6011760502755603 2.2991382575757573
    0.5381952631260782 2.3216382575757573
    0.49078171202252346 2.4047821969696974
    0.470831159201148 2.4956060606060606
    0.4516916075807712 2.616732954545455
    0.4413967656296533 2.7530492424242428
    0.439366126641867 2.9197064393939396
    0.44961360733194533 3.10157196969697
    0.47519334121294177 3.2532007575757578
    0.504549547706468 3.366960227272728
    0.5381952631260782 3.4655776515151517
    0.576737905470731 3.5566287878787883
    0.6180407640058407 3.63252840909091];
sat_points = [sat_points
    sat_points(1,:)];

acc_cont_points = [0.632455532033676 4.746212121212121
    0.561000238572964 4.6474810606060615
    0.49304998082727314 4.5108522727272735
    0.439366126641867 4.328797348484849
    0.39881592966356066 4.139204545454546
    0.3738836268477997 3.9648295454545455
    0.35212995566885363 3.782888257575758
    0.33781567478090213 3.600984848484849
    0.3285975697940157 3.434261363636364
    0.3285975697940157 3.222140151515152
    0.3301162645591665 3.0100284090909097
    0.33937697329323513 2.8055397727272733
    0.353757411163008 2.6086553030303032
    0.3790916091937177 2.3891003787878797
    0.41380248715672535 2.2301893939393933
    0.4516916075807712 2.1318844696969697
    0.504549547706468 2.04877840909091
    0.566197823952545 2.0035606060606064
    0.6383151402842807 2.0038068181818183
    0.7130121745001284 2.034337121212122
    0.7891391598736293 2.087575757575758
    0.8774306883611129 2.1787026515151524
    0.9756005683473422 2.2849810606060608
    1.0847540228362043 2.413986742424243
    1.184077678631783 2.5505303030303033
    1.257226912477451 2.671865530303031
    1.3287539510829733 2.7856155303030308
    1.3978896642486467 2.9220833333333336
    1.4638569658937695 3.058541666666667
    1.525885052077686 3.2177178030303035
    1.5614737710487105 3.3465530303030313
    1.597892537418309 3.498115530303031
    1.6276381791166805 3.6723958333333337
    1.6427180094293088 3.801202651515152
    1.6503102361250297 3.9375757575757584];

acc_dotted_points = [1.6427180094293088 3.9375662878787887
    1.6201502548682793 4.051174242424243
    1.5905414575341008 4.225378787878789
    1.5614737710487105 4.331401515151516
    1.518865241515165 4.422253787878788
    1.4774193871559795 4.505530303030303
    1.4304931046884795 4.596373106060607
    1.3850573103013188 4.664488636363637
    1.3348951153981812 4.732594696969698
    1.2630374969312042 4.793087121212122
    1.200571194805521 4.830861742424243
    1.12551650828379 4.861032196969697
    1.074796192885223 4.883664772727273
    1.016939741193085 4.891126893939394
    0.966644745778201 4.898598484848486
    0.9146101038546528 4.8909090909090915
    0.8733940820612812 4.890814393939395
    0.8150262941778946 4.8830965909090915
    0.7640742612779222 4.852660984848486
    0.7163075362326604 4.82222537878788
    0.6808809688647629 4.79939393939394
    0.632455532033676 4.753787878787879];

poor_points = [0.36536216489918355 5.17690340909091
    0.34729237407085206 5.078314393939395
    0.32708586176062376 4.956979166666667
    0.30805502496252196 4.812916666666667
    0.28879671406014246 4.638541666666667
    0.27451363629149556 4.479346590909092
    0.2621429441590959 4.305009469696969
    0.2514866859365871 4.100378787878789
    0.2423786699276677 3.888181818181819
    0.23685443600932715 3.6684375
    0.23360051613515076 3.441136363636364
    0.23360051613515076 3.1987121212121217
    0.23576479084279633 2.9866098484848487
    0.24126361060850662 2.766960227272728
    0.2491780873042957 2.5776325757575766
    0.2621429441590959 2.4034943181818185
    0.2783374522300894 2.2445265151515166
    0.29689829080565217 2.09314393939394
    0.3181605452684534 1.9948011363636367
    0.33781567478090213 1.9191666666666665
    0.3636813219150988 1.8359848484848484
    0.3879332874875699 1.7755113636363644
    0.4176363068405654 1.7302083333333327
    0.44961360733194533 1.6849053030303036
    0.49078171202252346 1.6547821969696974
    0.5406826653586966 1.6246780303030306
    0.6067458586902855 1.6249147727272728
    0.6840278283006193 1.6403125000000003
    0.7711532978562923 1.6784375000000011
    0.857432507947449 1.7316856060606058
    0.9402675424190471 1.7849053030303033
    1.016939741193085 1.8456723484848485
    1.120338587009587 1.9367803030303037
    1.2061199308776862 2.0202651515151517
    1.286549629290258 2.111306818181818
    1.3472627239266852 2.187159090909091
    1.4173614575291582 2.2781723484848486];

cc = lines(3);

fig_handle = figure;
semilogx(sat_points(:,1),sat_points(:,2),'LineWidth',1,'Color',cc(1,:));
hold on
% grid on
semilogx(acc_cont_points(:,1),acc_cont_points(:,2),'LineWidth',1,'Color',cc(2,:));
semilogx(acc_dotted_points(:,1),acc_dotted_points(:,2),':','LineWidth',1,'Color',cc(2,:))
semilogx(poor_points(:,1),poor_points(:,2),'LineWidth',1,'Color',cc(3,:));
xlim([0.1 4])
ylim([0 6])
xlabel('\zeta_{sp}')
ylabel('\omega_{n,sp} [rad/s]')
[val,i] = max(sat_points(:,2));
text(sat_points(i,1)-0.22,val-0.6,{'Satisfactory',' '},'Color',cc(1,:))
[val,i] = max(acc_cont_points(:,1));
text(val-1.13,acc_cont_points(i,2)+0.42,'  Acceptable','Color',cc(2,:))
[val,i] = max(poor_points(:,1));
text(val-1.14,poor_points(i,2)+2.1,'  Poor','Color',cc(3,:))
text(0.2,1.0,'Unacceptable')
plot(0.7,3.0,'o','Color',[0.6 0.6 0.6],'MarkerFaceColor',[0.6 0.6 0.6])
semilogx([0.7 0.7],[0 3.0],'--','Color',[0.6 0.6 0.6])
semilogx([0.1 0.7],[3.0 3.0],'--','Color',[0.6 0.6 0.6])
set(gca,'XTick',[0.1:0.1:1.0 2.0 3.0 4.0])
set(gca,'XTickLabel',{'0.1' '' '' '' '0.5' '' '0.7' '' '' '1.0' '2.0' '3.0' '4.0'})

if nargout==1
    varargout{1} = fig_handle;
end
